function validateInput(){function t(t){var e="";return $.each(t,function(t,o){console.log(o),e+=o.toString()}),e}var e=t(inputArray);console.log(e),e.length>=3&&(-1!=$.inArray(e,codes)?setTimeout(function(){Finch.navigate("article/"+e),$("#input0, #input1, #input2").text(""),inputArray=[]},500):($("#notification").animate({top:"50px",opacity:"show"},500),setTimeout(function(){$("#notification").animate({top:"0px",opacity:"show"},500)},1800),setTimeout(function(){console.log("kaka"),$("#input0, #input1, #input2").text(""),inputArray=[]},500)))}function showArticle(t){myDatabase.once("value",function(e){queryArticle(e.val().articles[t],t)}),currentArticleKey=t}function queryArticle(t,e){function o(t){displayArticle(t,a)}var a=e;$.ajax({type:"GET",url:"content/"+t,dataType:"json",success:o,error:error})}function displayArticle(t,e){$content=$("#content"),$content.html("");var o=$("<p></p>").attr("class","context").text(t.context),a=$("<p>&#x25AC</p>").attr("id","divider1"),n=$("<p>&#x25AC</p>").attr("id","divider2"),i=$("<p></p>").attr("class","title").text(t.title);if($content.append(o).append(a).append(i).append(n),$owl=$("<div></div>").attr({id:"articleOwl","class":"owl-carousel owl-theme"}),$.each(t.media.src,function(t,e){$tempEl=$("<div></div>").attr("class","item").append($("<img src='"+e+"'>")),$owl.append($tempEl)}),$content.append($owl),$("#articleOwl").owlCarousel({navigation:!0,slideSpeed:300,paginationSpeed:400,singleItem:!0,navigation:!1}),$.each(t.text,function(e){var o=$("<p></p>").attr("class","text").text(t.text[e]);$content.append(o)}),console.log($content.html()),""!=t.link){var r=$("<div></div>").attr("id","linkContainer"),s=$("<a></a>").attr({href:t.link,"class":"link"}),c=$("<p></p>").attr("id","linkP").text("LINK ZUR ORIGINALQUELLE");s.append(c),r.append(s),$content.append(r)}var l=[{name:"favorites",text:"ALS FAVORIT HINZUFÜGEN",url:"logos/favorites.svg"},{name:"share",text:"BEITRAG TEILEN",url:"logos/share.svg"},{name:"similar",text:"ÄHNLICHE BEITRÄGE",url:"logos/similar-01.svg"}],u=$("<div></div>").attr("id","featureLogoContainer");$.each(l,function(t,o){var a=$("<div></div>").attr({"class":"featureLogo",id:l[t].name});"favorites"==o.name&&-1!=$.inArray(e,userFavArray)?(a.append($("<img src='logos/favorites_true.svg'>").css("width","55%")),a.append($("<p></p>").text("ALS FAVORIT HINZUGEFÜGT"))):(a.append($("<img src='"+l[t].url+"'>")),a.append($("<p></p>").text(l[t].text))),u.append(a),a.on("click",function(){callFeature(l[t].name,e)})}),$content.append(u)}function callFeature(t,e){"favorites"==t?-1==$.inArray(e,userFavArray)?addToFavorites(t,e):removeFromFavorites(t,e):"share"==t?(window.location="mailto:?body=Habe über das Toni-Areal einen spannenden Beitrag gefunden: http://"+location.host+window.location.pathname+"#"+lastArticle,console.log("share")):"similar"==t&&($("#notification-article").animate({top:"50px",opacity:"show"},500),setTimeout(function(){$("#notification-article").animate({top:"0px",opacity:"show"},500)},1800))}function addToFavorites(t,e){{var o=myDatabase.child("users").child(userID);$.cookie("ToniFerner")}console.log(o),userFavArray.push(e),o.set(userFavArray),$("#"+t).find("img").attr("src","logos/favorites_true.svg"),$("#"+t).find("p").text("ALS FAVORIT HINZUGEFÜGT"),console.log("Added article "+e+" to Database")}function removeFromFavorites(t,e){userFavArray=$.grep(userFavArray,function(t){return t!=e}),console.log("The new Array: "+userFavArray);{var o=myDatabase.child("users").child(userID);$.cookie("ToniFerner")}o.set(userFavArray),$("#"+t).find("img").attr("src",""),$("#"+t).find("img").attr("src","logos/favorites.svg"),$("#"+t).find("p").text("ALS FAVORIT HINZUFÜGEN"),console.log("Removed article"+e+" from Database")}function error(t,e){console.log(e)}function buildKeyboard(){function t(){console.log("hole  background JSON"),$("#keypadBackground").attr("src","img/keypad1.png"),$("#aboutBackgroundImg").attr("src","img/keypad1.png")}$("#myKeypad").children().each(function(t,e){var o=$(e),a=o.data("key");$p=$("<p>"+a+"</p>").addClass("keyTag"),o.append($p),o.on("touchend",function(){"delete"==a?(inputArray.pop(),$("#input"+inputArray.length).text(""),console.log("Input array: "+inputArray),console.log("InputArray length: "+inputArray.length)):"delete"!=a&&"empty"!=a&&($("#input"+inputArray.length).text(a),inputArray.push(a),validateInput())})}),t(),$(".header").css("border-bottom","1px solid grey")}function setView(t,e,o){currentScreens[1]=t;var a=$("."+t);$.each(mainScreens,hideAndPark),null==lastScreen||"keypad"==lastScreen&&"article"==t?(a.css("left","0"),a.animate({opacity:"show"},500)):"menu"==lastScreen?(a.css("left","80%").show(),$(".header").animate({left:0,opacity:"show"},500).show(),$("."+lastScreenType).animate({left:"-80%",opacity:"show"},500).show(),a.animate({left:0,opacity:"show"},500).show()):"menu"==t?($("."+lastScreenType).css("left","0").show(),a.css("left","-80%").show(),$("."+lastScreenType).animate({left:"80%",opacity:"show"},500).show(),a.animate({left:0,opacity:"show"},500).show(),$(".header").animate({left:"80%",opacity:"show"},500)):"list"==lastScreenType&&"article"==t?($("."+lastScreenType).css("left","0").show(),$("."+lastScreenType).animate({left:"-100%",opacity:"show"},500).show(),a.css("left","100%").show(),a.animate({left:0,opacity:"show"},500).show()):"article"==lastScreenType&&"list"==t?($("."+lastScreenType).css("left","0").show(),$("."+lastScreenType).animate({left:"100%",opacity:"show"},500).show(),a.css("left","-100%").show(),a.animate({left:0,opacity:"show"},500).show()):"keypad"==t?(a.css("left","0"),a.animate({opacity:"show"},500)):"keypad"==lastScreenType?(a.css("left","0"),a.animate({opacity:"show"},500)):(a.css("left","0"),a.animate({opacity:"show"},500)),void 0!=o?(lastScreen=o,lastArticle=o,lastScreenType=t):(lastScreen=t,lastScreenType=t)}function setButtonControls(t,e){var o=lastScreen,a=lastArticle;$leftButton=$("#leftButton"),$rightButton=$("#rightButton"),$leftButton.off(),$rightButton.off(),"back"==e?$rightButton.on("click",function(){"menu"==o?goTo(a):goTo(o)}):"info"==e?$rightButton.on("click",function(){goTo("info")}):$rightButton.on("click",function(){goTo(e)}),"back"==t?$leftButton.on("click",function(){console.log(lastScreenType),null==lastArticle?(console.log("kaka"),goTo("list")):goTo(o)}):$leftButton.on("click",function(){goTo(t)})}function setButtonViews(t,e){$leftButton=$("#leftButton"),$rightButton=$("#rightButton"),$leftButton.html(""),$rightButton.html(""),""!=e&&$rightButton.append("<img src='"+screenToLogoUrl[e]+"'></a>"),""!=t&&$leftButton.append("<img src='"+screenToLogoUrl[t]+"'></a>")}function hideAndPark(t,e){$("."+e).hide(),$("."+e).css("left","200%")}function goTo(t){"back"==t?Finch.navigate(lastScreen):Finch.navigate(t,!0)}function showList(){function t(t){console.log(Object.keys(t).length);var o=$("<li></li>").html("<div><p>ALLE BEITRÄGE</p></div>");i.append(o),$.each(t,e)}function e(t,e){function i(e){var a=$("<li></li>").html("<a href=#article/"+t+"/true><div class='article-list-item'><div class='article-logo'><img src='"+e.media.src[0]+"'></div><div class='article-text'><p>"+e.context+" </p><p>"+e.title+"</p></div><div class='article-nav'><img src='logos/arrow_right.svg'></div></div></a>");o(a)}a=e,n=t,$.ajax({type:"GET",url:"content/"+e,dataType:"json",success:i,error:error})}function o(t){$(i).append(t)}$(".list").html("");var a,n,i=$("<ul></ul>").attr("id","article-list");myDatabase.once("value",function(e){t(e.val().articles)}),$(".list").append(i)}function showFavList(){function t(t){var o=$("<li></li>").html("<div><p>MEINE FAVORITEN</p></div>");i.append(o),$.each(t,function(t,o){myDatabase.once("value",function(t){e(o,t.val().articles[o])})})}function e(t,e){function i(e){var a=$("<li></li>").html("<a href=#article/"+t+"/true><div class='article-list-item'><div class='article-logo'><img src='"+e.media.src[0]+"'></div><div class='article-text'><p>"+e.context+" </p><p>"+e.title+"</p></div><div class='article-nav'><img src='logos/arrow_right.svg'></div></div></a>");o(a)}a=e,n=t,$.ajax({type:"GET",url:"content/"+e,dataType:"json",success:i,error:error})}function o(t){$(i).append(t)}$(".list").html("");var a,n,i=$("<ul></ul>").attr("id","article-list");myDatabase.once("value",function(e){t(e.val().users[userID])}),$(".list").append(i)}window.navigator.standalone;var myDatabase=new Firebase("https://toni-ferner.firebaseio.com/"),currentArticleKey,userFavArray=[],inputArray=[],codes=["456","123","789","159","753","258","159","333","222"],userID,currentScreens=new Array(3),lastScreen,lastScreenType,lastArticle,screenToLogoUrl={menu:"logos/burger.svg",keypad:"logos/keypad.svg",back:"logos/arrow_left.svg",cross:"logos/cross.svg",info:"logos/about_black.svg"},mainScreens=["article","list","keypad","about"];$(document).ready(function(){Finch.route("/article/:articleId/:direction",function(t){showArticle(t.articleId),url="/article/"+t.articleId,urltolist="/article/"+t.articleId+"/"+t.direction,backToList=t.direction,"true"==backToList?(setButtonControls("back",""),setButtonViews("back",""),setView("article","",urltolist)):(setButtonControls("menu","keypad"),setButtonViews("menu","keypad"),setView("article","",url))}),Finch.route("/menu",function(){setButtonControls("back",""),setButtonViews("menu",""),setView("menu")}),Finch.route("/keypad/:direction",function(t){setButtonControls("","back"),setButtonViews("","cross"),setView("keypad",t.direction)}),Finch.route("/",function(){showList(),setButtonControls("menu","keypad"),setButtonViews("menu","keypad"),setView("list")}),Finch.route("/list/:listType",function(t){"all"==t.listType?showList():"favorites"==t.listType&&showFavList(),setButtonControls("menu","keypad"),setButtonViews("menu","keypad"),url="/list/"+t.listType,setView("list","",url)}),Finch.route("/about",function(t){setButtonControls("menu","back"),setButtonViews("menu","cross"),setView("about",t.direction)}),Finch.listen(),buildKeyboard();var t=new Date,e=t.getTime();void 0==$.cookie("ToniFerner")&&$.cookie("ToniFerner",e,{expires:365,path:"/"}),userID=$.cookie("ToniFerner"),myDatabase.once("value",function(t){if(userFavArray=[],void 0==t.val().users){var e={};e[$.cookie("ToniFerner")]=[999999],myDatabase.child("users").set(e)}console.log(userID),console.log(t.val().users[userID][0]),$.each(t.val().users[userID],function(t,e){console.log(e),userFavArray.push(e)}),console.log(userFavArray)})});