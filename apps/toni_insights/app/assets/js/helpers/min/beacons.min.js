"use strict";var $=require("jquery"),_=require("underscore");window.BeaconManager=function(){var n=[],e=[];return{updateBeacons:function(r){n=r,e.forEach(function(e){"update"===e[0]&&e[1].call(null,n)})},getBeaconArray:function(){return n},addEventListener:function(n,r){e.push([n,r])}}}();var rooms={4:{2:{C:[1,1],K:[3,6]},3:{C:[[2,3][19]]},5:{C:[20,23],E:[1,3]},6:{E:[4,6]},7:{E:[7,7]},8:{E:[8,12],G:[7,8]},9:{G:[1,6],K:[15,19]},10:{H:[1,6],K:[20,22]},11:{H:[7,17]},12:{F:[4,9]},13:{D:[[3,5],[20,25]],F:[1,3]},14:{D:[[6,8],[13,19]]},15:{D:[9,12]},16:{D:[1,2],K:[4,4]},17:{K:[7,13]},18:{K:[1,2]}}};module.exports={lastBeacon:{},roomNames:[],getRoomNames:function(){return this.roomNames},getLastBeacon:function(){return this.lastBeacon},startBeaconSearchStream:function(){this.beaconSearchTimer=window.setInterval(_.bind(this.getBeacons,this),500)},stopBeaconSearch:function(){window.clearTimeout(this.beaconSearchTimer)},getBeacons:function(){var n=window.BeaconManager,e=n.getBeaconArray();e.length>0?this.handleBeacons(e):this.roomNames=["no beacon length"]},hasBeacons:function(){var n=window.BeaconManager,e=n.getBeaconArray();return e.length>0?!0:!1},handleBeacons:function(n){if(n=n.filter(function(n){return"unknown"!==n.proximity}),n=n.sort(function(n,e){return"near"!=n.proximity&&"immediate"!=n.proximity||"far"!=e.proximity?"far"!=n.proximity||"near"!=e.proximity&&"immediate"!=e.proximity?"far"==n.proximity&&"far"==e.proximity||"near"==n.proximity&&"near"==e.proximity||"immediate"==n.proximity&&"immediate"==e.proximity?n.rssi>=0?1:n.rssi<e.rssi?-1:n.rssi>e.rssi?1:0:void 0:1:-1}),n.length>0&&(this.lastBeacon={major:n[0].major,minor:n[0].minor}),"undefined"!=typeof rooms[this.lastBeacon.major][this.lastBeacon.minor]){var e=rooms[this.lastBeacon.major][this.lastBeacon.minor],r=[];$.each(e,_.bind(function(n,e){for(var o=this.lastBeacon.major+"."+n,t=e[0];t<=e[1];t++)if(t instanceof Array)for(var i=t[0];t<=t[1];i++)1==t.toString().length&&(t="0"+t),r.push(o+t);else 1==t.toString().length&&(t="0"+t),r.push(o+t)},this)),this.roomNames=r}}};