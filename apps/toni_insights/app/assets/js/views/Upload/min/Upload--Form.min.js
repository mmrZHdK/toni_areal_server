"use strict";var Backbone=require("backbone"),$=require("jquery"),_=require("underscore"),UserModel=require("../../models/UserModel"),UploadTypes=require("../../collections/UploadCollection"),PicturePostView=require("./Post/Picture"),TextPostView=require("./Post/Text"),ColorPostView=require("./Post/Color"),FileUploadView=require("./Post/File"),template=require("../../templates/Upload/Upload--Form.hbs");Backbone.$=$,module.exports=Backbone.View.extend({events:{submit:"submitForm"},initialize:function(e){this.delegate=e.delegate,this.render(e.model)},render:function(){this.model.attributes.selectedRoomId=UserModel.get("selectedRoom"),this.$el.html(template(this.model.attributes));var e=".vFormContent";switch(this.model.attributes.type){case"text":{new TextPostView({el:this.$(e)})}break;case"picture":{new PicturePostView({el:this.$(e),delegate:{uploadFile:_.bind(this.triggerFormSubmit,this)}})}break;case"video":case"sound":{new FileUploadView({el:this.$(e)})}}return this},triggerFormSubmit:function(){this.$(".js-postForm").submit()},submitForm:function(e){e.preventDefault();var t=new FormData($(e.target).get(0));$.ajax({url:"http://insights.lukasgaechter.ch/api/post/",data:t,method:"POST",processData:!1,contentType:!1,success:_.bind(function(e){console.log(e),this.delegate.restoreRoomView()},this)})}});