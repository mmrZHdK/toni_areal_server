"use strict";var Backbone=require("backbone"),$=require("jquery"),_=require("underscore"),Beacons=require("../../helpers/beacons"),template=require("../../templates/Loader/Loader.hbs");Backbone.$=$,module.exports=Backbone.View.extend({loadingTimeout:8e3,beaconPingTime:500,events:{"click .js-loaderTryAgain":"tryAgain","click .js-searchRoom":"searchRoom","click .js-startStream":"startStream"},initialize:function(e){this.delegate=e.delegate,this.beaconSearchTimer=window.setInterval(_.bind(this.searchBeacons,this),this.beaconPingTime),this.loadingTimer=window.setTimeout(_.bind(this.loadPositionFail,this),this.loadingTimeout)},render:function(e,t){return e="undefined"==typeof e?!0:e,t="undefined"==typeof t?!1:t,this.$el.html(template({loadingStatus:e,beaconsFound:t})),this.$(".js-spin").velocity({rotateZ:"360deg"},{easing:"linear",duration:2e3,loop:!0}),this},searchBeacons:function(){Beacons.hasBeacons()&&(this.loadStreamButton(),window.clearTimeout(this.loadingTimer),window.clearInterval(this.beaconSearchTimer))},loadStreamButton:function(){this.$(".js-spin").velocity("stop",!0),this.$(".js-spin").velocity({rotateZ:"-0deg"}),this.$(".js-spin").addClass("small"),this.$(".button-spinner").addClass("visible")},tryAgain:function(e){e.preventDefault(),this.render(!0)},loadPositionFail:function(){this.loadStreamButton()},searchRoom:function(e){e.preventDefault(),this.delegate.loadRoomSelectView()},startStream:function(e){e.preventDefault(),this.delegate.loadStreamView()},stop:function(){this.$(".js-spin").velocity("stop",!0)}});